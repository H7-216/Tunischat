<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Shop Premium</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6c63ff;
            --secondary-color: #4d44db;
            --accent-color: #ff6584;
            --light-bg: #f8f9fa;
            --dark-bg: #2b2d42;
            --text-light: #f8f9fa;
            --text-dark: #2b2d42;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-bg);
            color: var(--text-dark);
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }
        
        .auth-container {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('https://images.unsplash.com/photo-1551434678-e076c223a692?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            background-blend-mode: overlay;
        }
        
        .auth-box {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .logo {
            width: 120px;
            margin-bottom: 30px;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.1));
        }
        
        .auth-input {
            border: none;
            border-bottom: 2px solid #ddd;
            border-radius: 0;
            padding: 15px 5px;
            margin-bottom: 25px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .auth-input:focus {
            border-bottom-color: var(--primary-color);
            box-shadow: none;
        }
        
        .auth-btn {
            background-color: var(--primary-color);
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 1px;
            border-radius: 50px;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .auth-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
        }
        
        .premium-header {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1a1a2e 100%);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .premium-nav {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .nav-btn {
            border-radius: 50px;
            padding: 8px 20px;
            font-weight: 600;
            margin: 0 5px;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .product-card {
            border: none;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            margin-bottom: 30px;
            background-color: white;
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }
        
        .product-img {
            height: 200px;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .product-card:hover .product-img {
            transform: scale(1.05);
        }
        
        .product-price {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .add-to-cart {
            background-color: var(--primary-color);
            border: none;
            border-radius: 50px;
            padding: 8px 20px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .add-to-cart:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
        }
        
        .cart-icon, .notification-icon {
            position: relative;
            margin-left: 15px;
            cursor: pointer;
        }
        
        .badge-circle {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .premium-footer {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1a1a2e 100%);
            color: var(--text-light);
            padding: 50px 0 20px;
            margin-top: 50px;
        }
        
        .footer-link {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s;
            margin: 0 15px;
        }
        
        .footer-link:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .legal-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            padding: 50px;
            overflow-y: auto;
            display: none;
        }
        
        .close-legal {
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: 30px;
            cursor: pointer;
            color: var(--primary-color);
            transition: all 0.3s;
        }
        
        .close-legal:hover {
            transform: rotate(90deg);
            color: var(--accent-color);
        }
        
        .admin-panel {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .order-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .order-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .validate-btn {
            background-color: var(--primary-color);
            border: none;
            border-radius: 50px;
            padding: 8px 25px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .validate-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
        }
        
        .payment-method {
            display: inline-block;
            background-color: #f8f9fa;
            padding: 5px 15px;
            border-radius: 50px;
            margin-left: 10px;
            font-size: 0.8rem;
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 80px 0;
            border-radius: 0 0 20px 20px;
            margin-bottom: 50px;
        }
        
        .section-title {
            position: relative;
            margin-bottom: 30px;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary-color);
        }
    </style>
</head>
<body>
    <!-- Authentification -->
    <div id="authSection" class="auth-container">
        <div class="auth-box">
            <svg class="logo" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 11V13H21V11H3ZM3 5V7H21V5H3ZM3 17V19H21V17H3Z" fill="var(--primary-color)"/>
            </svg>
            <h2 class="mb-4">Bienvenue sur E-Shop Premium</h2>
            <p class="mb-4">Veuillez entrer votre code d'accès pour continuer</p>
            <input type="password" id="authCode" class="form-control auth-input" placeholder="Votre code d'accès">
            <button onclick="checkAuth()" class="btn auth-btn">Accéder</button>
        </div>
    </div>

    <!-- Application (cachée au départ) -->
    <div id="appSection" style="display: none;">
        <!-- Header -->
        <header class="premium-header">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 11V13H21V11H3ZM3 5V7H21V5H3ZM3 17V19H21V17H3Z" fill="white"/>
                        </svg>
                        <h4 class="text-white mb-0 ms-2">E-Shop Premium</h4>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="cart-icon" onclick="openCart()">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17 18C17.5304 18 18.0391 18.2107 18.4142 18.5858C18.7893 18.9609 19 19.4696 19 20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22C16.4696 22 15.9609 21.7893 15.5858 21.4142C15.2107 21.0391 15 20.5304 15 20C15 19.4696 15.2107 18.9609 15.5858 18.5858C15.9609 18.2107 16.4696 18 17 18ZM7 18C7.53043 18 8.03914 18.2107 8.41421 18.5858C8.78929 18.9609 9 19.4696 9 20C9 20.5304 8.78929 21.0391 8.41421 21.4142C8.03914 21.7893 7.53043 22 7 22C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20C5 19.4696 5.21071 18.9609 5.58579 18.5858C5.96086 18.2107 6.46957 18 7 18ZM7.17 2.76L7.2 2.8L10.1 7.6L15.55 6.25C16.25 6.09 16.94 6.5 17.1 7.21C17.26 7.91 16.85 8.59 16.14 8.74L10.7 10.08L9.1 13H17V15H7C6.72 15 6.47 14.89 6.29 14.71C6.11 14.53 6 14.28 6 14C6 13.97 6 13.94 6.01 13.9L7.4 10.33L3 2H1V0H3.27L4.21 1.41L4.27 1.5C4.4 1.67 4.71 2.06 5.17 2.76H7.17Z" fill="white"/>
                            </svg>
                            <span id="cartCounter" class="badge-circle">0</span>
                        </div>
                        <div class="notification-icon" onclick="showNotifications()">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C13.1 22 14 21.1 14 20H10C10 21.1 10.9 22 12 22ZM18 16V11C18 7.93 16.37 5.36 13.5 4.68V4C13.5 3.17 12.83 2.5 12 2.5C11.17 2.5 10.5 3.17 10.5 4V4.68C7.64 5.36 6 7.92 6 11V16L4 18V19H20V18L18 16Z" fill="white"/>
                            </svg>
                            <span id="notificationBadge" class="badge-circle" style="display: none;"></span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg premium-nav">
            <div class="container">
                <button id="shopBtn" class="btn nav-btn btn-primary" onclick="showShop()">Boutique</button>
                <button id="adminBtn" class="btn nav-btn btn-danger" style="display: none;" onclick="showAdmin()">Admin</button>
                <button id="notificationsBtn" class="btn nav-btn btn-warning ms-auto" style="display: none;" onclick="showNotifications()">Notifications</button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="container my-5">
            <!-- Hero Section -->
            <div id="heroSection" class="hero-section text-center">
                <h1 class="display-4">Bienvenue sur E-Shop Premium</h1>
                <p class="lead">Découvrez nos produits exclusifs</p>
            </div>

            <!-- Shop Section -->
            <div id="shopSection">
                <h2 class="section-title">Nos Produits</h2>
                <div class="row" id="productList"></div>
            </div>

            <!-- Admin Section -->
            <div id="adminSection" class="admin-panel" style="display: none;">
                <h2 class="section-title">Espace Admin</h2>
                <form id="productForm" class="mb-4">
                    <input type="hidden" id="productId">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Nom du produit</label>
                            <input type="text" id="productName" class="form-control" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Prix (€)</label>
                            <input type="number" id="productPrice" class="form-control" step="0.01" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image</label>
                        <input type="file" id="productImage" class="form-control" accept="image/*">
                    </div>
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </form>
                <h3 class="section-title">Liste des Produits</h3>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Nom</th>
                                <th>Prix</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminProductList"></tbody>
                    </table>
                </div>
            </div>

            <!-- Notifications Section -->
            <div id="notificationsSection" class="admin-panel" style="display: none;">
                <h2 class="section-title">Notifications de Commandes</h2>
                <div id="ordersList"></div>
            </div>
        </main>

        <!-- Cart Modal -->
        <div class="modal fade" id="cartModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Votre Panier</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" id="cartItems"></div>
                    <div class="modal-footer">
                        <p class="text-danger me-auto">⚠️ Paiement en espèce uniquement <span class="payment-method">🚫 Carte bancaire</span></p>
                        <button class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                        <button class="btn btn-primary" onclick="checkout()">Commander</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="premium-footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <h5>E-Shop Premium</h5>
                        <p>Votre boutique en ligne haut de gamme</p>
                        <p>🚫 Paiement en espèces uniquement</p>
                    </div>
                    <div class="col-md-6 text-end">
                        <button class="footer-link" onclick="showLegalPage('privacy')">Confidentialité</button>
                        <button class="footer-link" onclick="showLegalPage('cgv')">CGV</button>
                        <button class="footer-link" onclick="showLegalPage('cookies')">Cookies</button>
                    </div>
                </div>
                <div class="text-center mt-4">
                    <p>&copy; 2024 E-Shop Premium - Tous droits réservés</p>
                </div>
            </div>
        </footer>

        <!-- Legal Pages -->
        <div id="privacyPage" class="legal-page">
            <span class="close-legal" onclick="hideLegalPages()">×</span>
            <h2>Politique de Confidentialité</h2>
            <div class="mt-4">
                <h4>1. Collecte des informations</h4>
                <p>Nous collectons des informations lorsque vous passez une commande sur notre site.</p>
                
                <h4>2. Utilisation des informations</h4>
                <p>Vos informations sont utilisées pour traiter vos commandes et améliorer votre expérience client.</p>
                
                <h4>3. Protection des informations</h4>
                <p>Nous mettons en œuvre des mesures de sécurité pour protéger vos informations personnelles.</p>
                
                <h4>4. Partage des informations</h4>
                <p>Nous ne vendons, n'échangeons et ne transférons pas vos informations personnelles.</p>
            </div>
        </div>

        <div id="cgvPage" class="legal-page">
            <span class="close-legal" onclick="hideLegalPages()">×</span>
            <h2>Conditions Générales de Vente</h2>
            <div class="mt-4">
                <h4>1. Prix</h4>
                <p>Les prix sont indiqués en euros et sont valables tant qu'ils sont visibles sur le site.</p>
                
                <h4>2. Commandes</h4>
                <p>Les commandes sont payables en espèces à la livraison.</p>
                
                <h4>3. Livraison</h4>
                <p>Les délais de livraison sont indicatifs et peuvent varier.</p>
                
                <h4>4. Retours</h4>
                <p>Les retours sont acceptés sous 14 jours après réception.</p>
                
                <h4>5. Garantie</h4>
                <p>Tous nos produits bénéficient d'une garantie de 2 ans.</p>
            </div>
        </div>

        <div id="cookiesPage" class="legal-page">
            <span class="close-legal" onclick="hideLegalPages()">×</span>
            <h2>Politique relative aux Cookies</h2>
            <div class="mt-4">
                <h4>1. Qu'est-ce qu'un cookie ?</h4>
                <p>Un cookie est un petit fichier stocké sur votre ordinateur lorsque vous visitez un site web.</p>
                
                <h4>2. Utilisation des cookies</h4>
                <p>Nous utilisons des cookies pour améliorer votre expérience de navigation.</p>
                
                <h4>3. Contrôle des cookies</h4>
                <p>Vous pouvez contrôler ou supprimer les cookies via les paramètres de votre navigateur.</p>
                
                <h4>4. Cookies tiers</h4>
                <p>Nous n'utilisons pas de cookies tiers sur notre site.</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const ownerCode = "1508";
        let products = JSON.parse(localStorage.getItem('products')) || [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        let clients = JSON.parse(localStorage.getItem('clients')) || [];
        let currentUser = null;

        function checkAuth() {
            const code = document.getElementById('authCode').value;
            
            if (code === ownerCode) {
                currentUser = { type: 'owner', name: 'Propriétaire' };
                document.getElementById('adminBtn').style.display = 'inline-block';
                document.getElementById('notificationsBtn').style.display = 'inline-block';
                showApp();
                showAdmin();
            } else {
                const client = clients.find(c => c.code === code);
                if (client) {
                    currentUser = { type: 'client', name: client.name, code: client.code };
                    showApp();
                    showShop();
                } else {
                    const name = prompt("Nouveau client ? Entrez votre nom :");
                    if (name) {
                        clients.push({ code, name });
                        localStorage.setItem('clients', JSON.stringify(clients));
                        currentUser = { type: 'client', name, code };
                        showApp();
                        showShop();
                    }
                }
            }
        }

        function showApp() {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('appSection').style.display = 'block';
            updateCartCounter();
            updateNotificationBadge();
        }

        function showShop() {
            document.getElementById('shopSection').style.display = 'block';
            document.getElementById('adminSection').style.display = 'none';
            document.getElementById('notificationsSection').style.display = 'none';
            document.getElementById('heroSection').style.display = 'block';
            renderProducts();
        }

        function showAdmin() {
            if (currentUser && currentUser.type === 'owner') {
                document.getElementById('shopSection').style.display = 'none';
                document.getElementById('adminSection').style.display = 'block';
                document.getElementById('notificationsSection').style.display = 'none';
                document.getElementById('heroSection').style.display = 'none';
                renderAdminProducts();
            } else {
                alert("Accès réservé au propriétaire !");
            }
        }

        function showNotifications() {
            if (currentUser && currentUser.type === 'owner') {
                document.getElementById('shopSection').style.display = 'none';
                document.getElementById('adminSection').style.display = 'none';
                document.getElementById('notificationsSection').style.display = 'block';
                document.getElementById('heroSection').style.display = 'none';
                renderOrders();
            } else {
                alert("Vous n'avez pas accès aux notifications.");
            }
        }

        function showLegalPage(page) {
            document.getElementById(page + 'Page').style.display = 'block';
        }

        function hideLegalPages() {
            document.querySelectorAll('.legal-page').forEach(page => {
                page.style.display = 'none';
            });
        }

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const productId = document.getElementById('productId').value;
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const imageInput = document.getElementById('productImage');
            
            let image = '';
            if (imageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    image = e.target.result;
                    saveProduct(productId, name, price, image);
                };
                reader.readAsDataURL(imageInput.files[0]);
            } else {
                saveProduct(productId, name, price, image);
            }
        });

        function saveProduct(id, name, price, image) {
            if (id) {
                const index = products.findIndex(p => p.id == id);
                products[index] = { ...products[index], name, price, image: image || products[index].image };
            } else {
                products.push({ id: Date.now(), name, price, image });
            }
            localStorage.setItem('products', JSON.stringify(products));
            document.getElementById('productForm').reset();
            renderAdminProducts();
            renderProducts();
        }

        function deleteProduct(id) {
            products = products.filter(p => p.id != id);
            localStorage.setItem('products', JSON.stringify(products));
            renderAdminProducts();
            renderProducts();
        }

        function editProduct(id) {
            const product = products.find(p => p.id == id);
            document.getElementById('productId').value = product.id;
            document.getElementById('productName').value = product.name;
            document.getElementById('productPrice').value = product.price;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function renderProducts() {
            const container = document.getElementById('productList');
            container.innerHTML = products.map(product => `
                <div class="col-md-4">
                    <div class="card product-card">
                        <img src="${product.image || 'https://via.placeholder.com/300'}" class="card-img-top product-img" alt="${product.name}">
                        <div class="card-body">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="product-price">${product.price.toFixed(2)} €</p>
                            <button class="btn add-to-cart" onclick="addToCart(${product.id})">
                                Ajouter au panier
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderAdminProducts() {
            const container = document.getElementById('adminProductList');
            container.innerHTML = products.map(product => `
                <tr>
                    <td><img src="${product.image || 'https://via.placeholder.com/50'}" width="50" height="50" style="object-fit: cover;"></td>
                    <td>${product.name}</td>
                    <td>${product.price.toFixed(2)} €</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-2" onclick="editProduct(${product.id})">Éditer</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${product.id})">Supprimer</button>
                    </td>
                </tr>
            `).join('');
        }

        function addToCart(productId) {
            const product = products.find(p => p.id == productId);
            const existingItem = cart.find(item => item.id == productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCounter();
        }

        function openCart() {
            const modal = new bootstrap.Modal(document.getElementById('cartModal'));
            const container = document.getElementById('cartItems');
            
            container.innerHTML = cart.map(item => `
                <div class="d-flex justify-content-between align-items-center mb-3 p-3 border-bottom">
                    <div class="d-flex align-items-center">
                        <img src="${item.image || 'https://via.placeholder.com/60'}" width="60" height="60" style="object-fit: cover; border-radius: 10px;" class="me-3">
                        <div>
                            <h6 class="mb-1">${item.name}</h6>
                            <p class="mb-0">${item.price.toFixed(2)} € x ${item.quantity}</p>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${item.id})">Retirer</button>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            container.innerHTML += `
                <div class="d-flex justify-content-between p-3">
                    <h5>Total</h5>
                    <h5>${total.toFixed(2)} €</h5>
                </div>
            `;
            
            modal.show();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id != productId);
            localStorage.setItem('cart', JSON.stringify(cart));
            openCart();
            updateCartCounter();
        }

        function checkout() {
            if (cart.length === 0) {
                alert("Votre panier est vide !");
                return;
            }

            if (!currentUser) {
                alert("Veuillez vous connecter pour passer commande.");
                return;
            }

            const order = {
                id: Date.now(),
                items: [...cart],
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                date: new Date().toLocaleString(),
                clientName: currentUser.name,
                clientCode: currentUser.code,
                status: "En attente"
            };

            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            cart = [];
            localStorage.setItem('cart', JSON.stringify(cart));
            
            updateCartCounter();
            updateNotificationBadge();
            
            alert("Commande validée ! Paiement en espèce à la livraison.");
            document.getElementById('cartModal').querySelector('.btn-close').click();
        }

        function renderOrders() {
            const container = document.getElementById('ordersList');
            const pendingOrders = orders.filter(order => order.status === "En attente");
            
            if (pendingOrders.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-info">
                        Aucune commande en attente de validation.
                    </div>
                `;
                return;
            }

            container.innerHTML = pendingOrders.map(order => `
                <div class="card order-card mb-4">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h5 class="card-title">Commande #${order.id}</h5>
                                <p class="card-text"><strong>Client:</strong> ${order.clientName}</p>
                                <p class="card-text"><strong>Date:</strong> ${order.date}</p>
                                <p class="card-text"><strong>Total:</strong> ${order.total.toFixed(2)} €</p>
                            </div>
                            <button class="btn validate-btn" onclick="validateOrder(${order.id})">
                                Valider la commande
                            </button>
                        </div>
                        <h6>Articles:</h6>
                        <div class="row">
                            ${order.items.map(item => `
                                <div class="col-md-4 mb-3">
                                    <div class="d-flex align-items-center">
                                        <img src="${item.image || 'https://via.placeholder.com/50'}" width="50" height="50" style="object-fit: cover; border-radius: 5px;" class="me-3">
                                        <div>
                                            <p class="mb-0"><strong>${item.name}</strong></p>
                                            <p class="mb-0">${item.price.toFixed(2)} € x ${item.quantity}</p>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function validateOrder(orderId) {
            const orderIndex = orders.findIndex(o => o.id == orderId);
            if (orderIndex !== -1) {
                orders[orderIndex].status = "Validée";
                localStorage.setItem('orders', JSON.stringify(orders));
                renderOrders();
                updateNotificationBadge();
            }
        }

        function updateCartCounter() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCounter').textContent = totalItems;
        }

        function updateNotificationBadge() {
            if (currentUser && currentUser.type === 'owner') {
                const pendingCount = orders.filter(o => o.status === "En attente").length;
                const badge = document.getElementById('notificationBadge');
                if (pendingCount > 0) {
                    badge.textContent = pendingCount;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        // Exemple de données initiales si vide
        if (products.length === 0) {
            products = [
                { id: 1, name: "Smartphone Premium", price: 799.99, image: "" },
                { id: 2, name: "Écouteurs Sans Fil", price: 149.99, image: "" },
                { id: 3, name: "Chargeur Rapide", price: 29.99, image: "" },
                { id: 4, name: "Étui Protecteur", price: 19.99, image: "" },
                { id: 5, name: "Batterie Externe", price: 49.99, image: "" },
                { id: 6, name: "Câble USB-C", price: 12.99, image: "" }
            ];
            localStorage.setItem('products', JSON.stringify(products));
        }
    </script>
</body>
</html>